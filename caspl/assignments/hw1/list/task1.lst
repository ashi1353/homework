     1                                  section	.rodata
     2                                  LC0:
     3 00000000 54686520726573756C-     	DB	"The result is:  %u", 10, 0	; Format string
     4 00000009 742069733A20202575-
     5 00000012 0A00               
     6                                  
     7                                  section .bss
     8                                  LC1:
     9 00000000 <res 00000004>          	RESD	1
    10                                  
    11                                  section .text
    12                                  	align 16
    13                                  	global my_func
    14                                  	extern printf
    15                                  
    16                                  my_func:
    17 00000000 55                      	push	ebp
    18 00000001 89E5                    	mov	ebp, esp	; Entry code - set up ebp and esp
    19 00000003 60                      	pusha			; Save registers
    20                                  
    21 00000004 8B4D08                  	mov ecx, dword [ebp+8]	; Get argument (pointer to string)
    22                                  
    23                                  ;       Your code should be here...
    24 00000007 C705[00000000]0000-     	mov	dword [LC1], 0		; initialize answer
    25 0000000F 0000               
    26                                  
    27                                  loop:
    28 00000011 8A01                        mov al, byte [ecx]
    29                                  
    30                                      ; if al == \n, skip it
    31 00000013 3C0A                        cmp al, 10
    32 00000015 7437                            je next
    33                                  
    34 00000017 C125[00000000]04            shl dword[LC1], 4 ; multiply by 16 each digit we add
    35                                  
    36                                      ; if al >= 'a'
    37 0000001E 3C61                        cmp al, 'a'
    38 00000020 7D0A                            jge ge_a
    39                                  
    40                                      ; if al >= 'A'
    41 00000022 3C41                        cmp al, 'A'
    42 00000024 7D0C                            jge ge_A
    43                                  
    44                                      ; if al >= '0'
    45 00000026 3C30                        cmp al, '0'
    46 00000028 7D0E                            jge ge_0
    47                                  
    48                                      ; default
    49                                      ; do nothing
    50 0000002A EB22                        jmp next
    51                                  
    52                                      ge_a: ; a <= al
    53                                          ; if al <= 'f'
    54 0000002C 3C66                            cmp al, 'f'
    55 0000002E 7E0E                                jle a_f
    56                                          ; else
    57 00000030 EB1C                                jmp next
    58                                  
    59                                      ge_A: ; A <= al
    60                                          ; if al <= 'F'
    61 00000032 3C46                            cmp al, 'F'
    62 00000034 7E0E                                jle A_F
    63                                          ; else
    64 00000036 EB16                                jmp next
    65                                  
    66                                      ge_0: ; 0 <= al
    67                                          ; if al <= '9'
    68 00000038 3C39                            cmp al, '9'
    69 0000003A 7E0E                                jle n0_9
    70                                          ; else
    71 0000003C EB10                                jmp next
    72                                  
    73                                      a_f: ; [a, f]
    74 0000003E 2C61                            sub al, 'a'
    75 00000040 040A                            add al, 10
    76                                          add dword[LC1], al
    77          ******************       error: mismatch in operand sizes
    78 00000042 EB0A                            jmp next
    79                                  
    80                                      A_F: ; [A, F]
    81 00000044 2C41                            sub al, 'A'
    82 00000046 040A                            add al, 10
    83                                          add dword[LC1], al
    84          ******************       error: mismatch in operand sizes
    85 00000048 EB04                            jmp next
    86                                  
    87                                      n0_9: ; [0, 9]
    88 0000004A 2C30                            sub al, '0'
    89                                          add dword[LC1], al
    90          ******************       error: mismatch in operand sizes
    91 0000004C EB00                            jmp next
    92                                  
    93                                      next:
    94 0000004E 41                          	inc	ecx      		; increment pointer
    95 0000004F 803900                      	cmp	byte [ecx], 0   ; check if byte pointed to is zero
    96 00000052 75BD                        	jnz	loop       		; keep looping until it is null terminated
    97                                  
    98 00000054 FF35[00000000]          	push	dword[LC1]		; Call printf with 2 arguments: pointer to str
    99 0000005A 68[00000000]            	push	LC0		; and pointer to format string.
   100 0000005F E8(00000000)            	call	printf
   101 00000064 83C408                  	add 	esp, 8		; Clean up stack after call
   102                                  
   103 00000067 61                      	popa			; Restore registers
   104 00000068 89EC                    	mov	esp, ebp	; Function exit code
   105 0000006A 5D                      	pop	ebp
   106 0000006B C3                      	ret
   107                                  
